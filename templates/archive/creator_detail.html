{% extends "base.html" %}
{% load autop %}
{% load thumbnail %}
{% load i18n %}

{% block body_class %}detail{% endblock %}

{% block content %}
        <header>
            <nav class="breadcrumbs">
                <ul>
                    <li><a href="/">{% trans "Home" %}</a></li>
                    <li><a href="/creators">{% trans "Creators" %}</a></li>
                    <li>{{ creator.display_name }}</li>
                </ul>
            </nav>
            <h2>{{ creator.display_name }}</h2>
        </header>
        
        <section class="main">
            {% if creator.photo %}
                {% thumbnail creatorphoto "100x100" crop="center" as im %}
                    <img src="{{ im.url }}" />
                {% endthumbnail %}
            {% endif %}

            <p><strong>{{ creator.display_roles }}</strong></p>

            {% if creator.biography %}
                {{ creator.biography|autop }}
            {% endif %}

            {% if creator.notes %}
              <h4>{% trans "Notes" %}:</h4>
              {{ creator.notes|autop }}
            {% endif %}

            {% if creator.website %}
              <h4>{% trans "Website" %}:</h4>
              <a href="{{ creator.website }}">{{ creator.website }}</a>
            {% endif %}

            {% if creator.has_works %}
            <div class="linkeditems">
              <h3>{% trans "Written texts" %}</h3>
                <ul>
                  {% for work in creator.works %}
                  <li>
                    <a href="{{ SITE_URL }}/writtenwork/{{ work.record_id }}">{{ work.record_title|safe }}</a><br />
                    <span>{{ work.function }}</span>
                    {% if work.date %}<br /><span>{{ work.date }}</span>{% endif %}
                  </li>
                  {% endfor %}
                </ul>
            </div>
            {% endif %}
            
            {% if creator.has_productions %}
            <div class="linkeditems">
              <h3>{% trans "Productions" %}</h3>
                <ul>
                  {% for production in creator.productions %}
                  <li>
                    <a href="{{ SITE_URL }}/production/{{ production.prod_id }}">{{ production.prod_title }}</a><br />
                    <span>{{ production.role }}</span><br />
                    <span><a href="{{ SITE_URL }}/venue/{{ production.venue.pk }}">{{ production.venue.title }}</a></span><br />
                    <span>{{ production.date_range|safe }}</span>
                  </li>
                  {% endfor %}
                </ul>
            </div>
            {% endif %}

            {% if videos %}
            <hr />
            <ul class="videos">
              {% for vid in videos %}
              <li>
                <a id="{{ vid.object_id }}" class="fancybox">
                  {% if vid.poster %}
                  {% thumbnail vid.poster "200x134" crop="center" as im %}
                    <img src="{{ im.url }}" alt="Link to video of {{ vid.title }}" />
                  {% endthumbnail %}
                  {% else %}
                    Click to play video
                  {% endif %}
                </a>
                <a href="/digitalobject/{{vid.pk}}">{{ vid.title}}</a>
              </li>
              {% endfor %}
            </ul>
            {% endif %}

        </section>

        <aside>
          <div class="data">
            <ul>
              {% if creator.nationality %}
                <li>
                  <h4>{% trans "Nationality" %}:</h4>
                  <span>{{ creator.nationality.demonym }}</span>
                </li>
              {% endif %}
              {% if creator.birth_date %}
                <li>
                  <h4>{% trans "Birth date" %}:</h4>
                  <span>{{ creator.birth_date_display }}</span>
                </li>
              {% endif %}
              {% if creator.birth_location %}
                <li>
                  <h4>{% trans "Place of birth" %}:</h4>
                  <span>{{ creator.birth_location }}</span>
                </li>
              {% endif %}
              {% if creator.death_date %}
                <li>
                  <h4>{% trans "Death date" %}:</h4>
                  <span>{{ creator.death_date_display }}</span>
                </li>
              {% endif %}
              {% if creator.death_location %}
                <li>
                  <h4>{% trans "Place of death" %}:</h4>
                  <span>{{ creator.death_location }}</span>
                </li>
              {% endif %}
              {% if creator.has_related_creators %}
                <li>
                  <h4>{% trans "Related creators" %}:</h4>
                </li>
              {% endif %}
            </ul>
          </div>
          {% if creator.has_digital_objects %}
          <div class="objects">
            <a id="next">Next</a>
            <a id="prev">Prev</a>
            <a id="caption" href="/digitalobject/{{ digital_objects.0.pk }}">View details</a>
            <div id="digitalobjects">
                {% for obj in digital_objects %}
                {% thumbnail obj.image "800" as im %}
                <a class="fancy" rel="gallery" href="{{ im.url }}" title="{{ obj.title }}">
                {% endthumbnail %}
                {% thumbnail obj.image "210x210" crop="center" as im %}
                <img src="{{ im.url }}" alt="{{ obj.title }}" data-href="/digitalobject/{{ obj.pk }}" />
                {% endthumbnail %}
                </a>
                {% endfor %}
            </div>
          </div>
          {% endif %}
      </aside>
  {% endblock %}

  {% block extra_js %}
  <script>
    $(document).ready(function() {
      {% for vid in videos %}
      $('#{{ vid.object_id }}').fancybox({
content: '<video id="vid-{{vid.object_id}}" src="http://streaming.miami.edu:8080/flash/ctda/{{ vid.object_id }}0001001.mp4" width={% if vid.hidef %}1280{% else %}720{% endif %} height={% if vid.hidef %}720{% else %}480{% endif %}></video>',
        maxWidth: {% if vid.hidef %}1310{% else %}750{% endif %},
        maxHeight: {% if vid.hidef %}775{% else %}535{% endif %},
        afterShow: function() {
          $('#vid-{{vid.object_id}}').mediaelementplayer();
        }
      });
      {% endfor %}
      $('.fancy').fancybox({loop: false});
    });
  </script>
  {% endblock %}


