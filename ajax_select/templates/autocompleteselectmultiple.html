<!--
Copyright (C) 2012  University of Miami

This program is free software; you can redistribute it and/or
 modify it under the terms of the GNU General Public License
 as published by the Free Software Foundation; either version 2
 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. 
 See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License
 along with this program; if not, write to the Free Software Foundation,
Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.
-->

{% load i18n %}
<input type="text" name="{{name}}_text" id="{{html_id}}_text" value="{{current_name}}" {{ extra_attrs }} />
{% if add_link %}
        <a href="{{ add_link }}" class="add-another" id="add_{{ html_id }}" onclick="return showAddAnotherPopup(this);"> <img src="{{ admin_media_prefix }}img/admin/icon_addlink.gif" width="10" height="10" alt="Add Another"></a>
{% endif %}
{% block help %}{% if help_text %}<p class="help">{{help_text}}</p>{% endif %}{% endblock %}
<p id="{{html_id}}_on_deck" class="results_on_deck"></p>
<input type="hidden" name="{{name}}" id="{{html_id}}" value="{{current_ids}}" />
<script type="text/javascript">

jQuery(document).ready(function($){{% block script %}
    useid = "{{html_id}}";
    if (useid.search(/__prefix__/) >= 0) {
        // we're adding another inline, let's try to correct ourselves:
        prefix = 0;
        newid = useid;
        //alert(newid+'_text'+' '+$('#'+newid+'_text').length);
        while ($('#'+newid+'_text').length) {
            newid = useid.replace(/__prefix__/,prefix++);
        }
        useid = newid
    }
    autocompleteselectmultiplevalues[useid] = {{current_reprs}};
    // call after 100ms so the new div gets situated
    setTimeout("setup_autocompleteselectmultiple('"+useid+"','{{lookup_url}}')",100);

{% block extra_script %}{% endblock %}
{% endblock %}});
</script>
